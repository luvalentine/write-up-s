# RSA (given p + q) (hard)

## Условие
Дан RSA. Известны `n = p * q`, сумма простых `x = p + q` и шифротекст `c`.
Нужно восстановить исходное сообщение.

---

## Анализ
Обычно в RSA известен только `n`, и факторизация сложная.
Но если дополнительно известна сумма `p + q`, то можно составить уравнение
`t² - x·t + n = 0` и найти `p` и `q`.

---

## Уязвимость
RSA полностью ломается, если известны и произведение, и сумма простых чисел.
Размер ключа в этом случае уже не имеет значения.

---

## Решение
Находим дискриминант `D = x² - 4n`, из него восстанавливаем `p` и `q`,
считаем приватный ключ и расшифровываем сообщение.

```python
import gmpy2
from Crypto.Util.number import long_to_bytes

x = int("x_hex", 16)
n = int("n_hex", 16)
c = int("c_hex", 16)
e = 65537

D = x*x - 4*n
s = gmpy2.isqrt(D)

p = (x + s) // 2
q = (x - s) // 2

phi = gmpy2.lcm(p-1, q-1)
d = pow(e, -1, phi)

m = pow(c, d, n)
print(long_to_bytes(m))
