## Условие
Дан «хэш» флага в `output.txt` и матрица `A` в `A.txt`.  
В `chal.sage` вычисляется:
- `x = sanitize(flag, l)`
- `h = A * x (mod 256)`

Нужно восстановить флаг в формате `BZHCTF{...}`.

---

## Анализ

### sanitize()
Функция:
1. делает PKCS7-pad до 16 байт,
2. XOR’ит все 16-байтные блоки,
3. переводит результат в «квинарные цифры» через `btq()`,
4. берёт первые `l` элементов.

Операции линейные (XOR + перевод основания).

### btq()
Переводит 16 байт в число и записывает его в базе 5 с алфавитом  
`[-2, -1, 0, 1, 2]`.  
Далее всё приводится к `Zmod(256)`, поэтому допустимые значения:
`{254, 255, 0, 1, 2}`.

---

## Идея решения
Вся схема — это **линейная система**:
A * x = h (mod 256)


Никакой one-way функции тут нет.

1. Решаем линейную систему по модулю 256.
2. С учётом ограничения `x[i] ∈ {254,255,0,1,2}` перебираем свободные переменные.
3. Получаем корректный вектор `x`.
4. Частично инвертируем `btq()` и восстанавливаем 16 байт.
5. Учитываем PKCS7 (XOR с `0x10`), получаем флаг.

---

## Результат
BZHCTF{7ffbeebcd72be3dc}
