## Потерянный корень  (700 pts)

## Условие
Даны:
- RSA модуль n = p * q
- ciphertext ct
- утечки:
  c1 = (p - a)^2 >> 128
  c2 = (q + a)^2 >> 128



## Анализ
Сдвиг >> 128 убирает младшие биты, но сохраняет старшую часть квадрата.
Это позволяет восстановить:
x = p - a
y = q + a

Так как:
x^2 >> 128 = c1
y^2 >> 128 = c2

Для каждого значения существует единственный подходящий целочисленный корень.

## Уязвимость
Используется связь между p и q через параметр a:
n = (p - a + a)(q + a - a)

Это позволяет выразить n через x, y и a
и свести задачу к квадратному уравнению.

## Решение
Подставляем:
n = (x + a)(y - a)

Получаем:
a^2 - a(y - x) + (n - xy) = 0

Решаем через дискриминант:
D = (y - x)^2 - 4(n - xy)
a = ((y - x) ± sqrt(D)) / 2

Выбираем корректный корень и восстанавливаем:
p = x + a
q = y - a

Далее считаем приватный ключ и расшифровываем ct.

## Флаг
qupiya{cr4ck3d_th3_r00t5_0f_th3_crypt0_rs4_puzzl3}
